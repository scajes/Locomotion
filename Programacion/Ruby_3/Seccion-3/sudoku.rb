class Sudoku
  
  def initialize(puzzle)
    @@p = puzzle.split(//)   
  end
  
#Algorithm to solve the sudoku puzzle
  def solve!
    
    #81 times for each block in the puzzle
    81.times do |j|
      next if @@p[j].to_i!=0
  
      candidatesArray = getCandidates(j)                   
      
      candidatesArray.each  do |v|      
           @@p[j]=v.to_s
           foundAll = solve!
           if(foundAll == true)
             return true
           end
      end
      
      # finished trying all the candidates, backtrack      
      @@p[j]=0  
      return false                       
    end
    
    return true
  end
    
  def getCandidates(j)
  
      Array array = [1,2,3,4,5,6,7,8,9]
      
      row = j/9 *9
      col = j%9
      
      #find the cells with the same row
      9.times do |k|
        m = @@p[row+k].to_i
        if(m)
          array.delete(m)
        end
      end

      #find the cells in the same column
      9.times do |k|
        m = @@p[k*9 + col].to_i
        if(m)
          array.delete(m)
        end
      end

      #find the cells in the same sub cube
      start_row = j/27 * 3
      start_col = j%9/3 * 3
      3.times do |t|
        3.times do |l|
          m =  @@p[(start_row + t)*9 + start_col + l].to_i
          if(m)
            array.delete(m)
          end
        end
      end

      return array
    
  end
  
  def board
    puts "\nGame solved!\n"
    print "---------------------\n"
    1.upto(81) do |x|
      print "#{@@p[x-1]} "
      if x%3==0 and x%9 !=0
        print "| "
      end
      if x%9==0 and x%81 !=0
        print"\n- - - - - - - - - - -\n"
      end
    end
    puts "\n---------------------\n"
  end
end




game = Sudoku.new('702806519100740230005001070008000002610204053200000100070400800064078005821503907')

game.solve!

puts game.board

=begin
test
702806519100740230005001070008000002610204053200000100070400800064078005821503907
609238745274561398853947621486352179792614583531879264945723816328196457167485932
308290400020800730050000002090304126410080073635102040500000090089003060003067801
098206050001087900206500000400100009050734080100005003000009805007350400010802630
530070000600195000098000060800060003400803001700020006060000280000419005000080079
105802000090076405200400819019007306762083090000061050007600030430020501600308900
005030081902850060600004050007402830349760005008300490150087002090000600026049503
290500007700000400004738012902003064800050070500067200309004005000080700087005109
080020000040500320020309046600090004000640501134050700360004002407230600000700450
608730000200000460000064820080005701900618004031000080860200039050000100100456200
370000001000700005408061090000010000050090460086002030000000000694005203800149500
400000805030000000000700000020000060000080400000010000000603070500200000104000000
000689100800000029150000008403000050200005000090240801084700910500000060060410000
005030081902850060600004050007402830349760005008300490150087002090000600026049503
096040001100060004504810390007950043030080000405023018010630059059070830003590007
000075400000000008080190000300001060000000034000068170204000603900000020530200000
300000000050703008000028070700000043000000000003904105400300800100040000968000200
302609005500730000000000900000940000000000109000057060008500006000000003019082040
010020300002003040050000006004700050000100003070068000300004090000600104006000000
010020300002003040080000006004700030000600008070098000300004090000800104006000000
010020300002003040050000006004200050000100007020087000300004080000600105006000000
005030081902850060600004050007402830349760005008300490150087002090000600026049503
010020300004003020050000006002700050000100008070098000300007090000600102007000000
010020300002003040050000006004700050000100008070038000300005090000600104006000000
010020300004001050060000007005400060000100002080092000300005090000700106007000000
010020300003004050060000007005800060000100009080092000400005090000700106007000000
010020300004003050050000006005700040000100002070082000300005090000600105006000000
000075400000000008080190000300001060000000034000068170204000603900000020530200000
010020300002003040050000006004700050000100008070095000300004090000900104006000000
010020300004005060070000008006300070000100002030092000900006040000800106008000000
080070100003002090060000004009500060000700005020041000100005020000200901004000000
010020300002003040040000006004700050000600008070098000300005080000800104009000000
020010700003008060010000003008600050000900004030021000400009080000500901007000000
010020300003004050060000007005800060000100002080072000400005090000700104007000000
010020300002003040050000006007800050000100004080094000300007090000400105006000000
010020300004003020050000006007600050000100002060072000300008070000900108009000000
010020300004003050060000007005800060000900001080012000300005010000700506002000000
010020300004003050020000006005700020000100008070098000300005090000900205006000000
010020300004003020050000006007800050000100002080042000300007040000600807006000000
070050800005008020010000009008100050000200001090034000900002030000600107006000000
010020300004005060070000004006800070000900002050017000400006050000400906008000000
010020300004005060070000008006900080000100002090032000200006030000800105008000000
010020300002003040050000006004700050000100008070098000200004090000600704006000000
010020300002003040050000006004700050000100008070068000300004090000800104006000000
010020300004001050060000007005800070000900002080014000300005010000700905007000000
010020300004003020050000006002700050000800009070019000300002010000600805006000000
010020300003004050060000007008900070000100002090082000200005080000700105007000000
010020300004003050020000006007800040000100005080095000300007090000600107006000000
010020300002003040050000006004700080000100003070068000300004090000600104006000000
090020500004005010060000003001800060000900002080072000500001070000300901003000000
010020300004001050060000007005800060000100003080092000300005090000700102007000000
010020300002003040050000006004700050000100008020098000700004090000600104006000000
010020300003004050060000004005700060000100002070032000400005080000900105009000000
010020300004003050060000007005800040000100002080092000600005090000700105002000000
010020300004003050060000007005100060000800002080092000300006090000700205007000000
010020300004005060070000008006900030000100002090042000500006040000800106008000000
010020300004003050060000007005200060000100008020048000300005090000700205009000000
070040800009005060060000003004100070000200006020034000100008090000600401007000000
010020300004003050060000007005200040000800001020091000300005090000700805007000000
010020300004001050060000007005200060000800009020019000300005010000700805007000000
010020300004001050060000007005800060000900002080014000300005010000700905007000000
010020300004003050060000007005800060000100002070092000400005090000700105007000000
010020300004005060050000004006700040000100002070082000300006080000900106009000000
010020300004003050020000006005700080000100002070098000800005090000600105006000000
010020300004003050060000007005800040000100008080092000300005090000700605007000000
010020300004005060070000008006900040000100002090032000500006030000800906008000000
010020300004003050060000007005800060000100002070092000300005090000700105007000000
010020300002003040050000006004700050000600008070098000300004090000800104006000000
010020300004003050060000007005800060000100009080042000300005040000700908001000000
070060900006002030020000006003100040000200008050034000900003020000700105008000000
010020300004003050060000001005700060000800002070012000400005090000400805007000000
000943000060010050000000000800000003750060014100000009000000000020050080000374000
000123000040050060000000000700000003860040092900000001000000000050060080000392000
000123000040050060000000000700000003860040072500000001000000000070060050000382000
000123000040050060000000000500000007360040052700000001000000000080060040000732000
000123000040050060000000000100000003760040082500000009000000000090060040000378000
000123000040050060000000000700000003460080052500000001000000000090060040000392000
000427000060090080000000000900000008120030045500000007000000000040060030000715000
000123000040050060000000000200000003760040082400000001000000000080060030000372000
000123000040050060000000000100000003360040052200000007000000000080060040000972000
000123000040050060000000000800000007460080052200000001000000000050060040000731000
000123000040050060000000000100000003760080052800000009000000000080060040000372000
000651000040020080000000000700000009120030045800000001000000000030040020000719000
000398000050010060000000000800000009120030045700000008000000000040020010000769000
000123000040050060000000000200000003570040082100000006000000000060070040000392000
000123000040050060000000000700000008810040027500000003000000000090060040000387000
000123000040050060000000000400000003560040072700000001000000000080060040000372000
000123000040050060000000000700000003460080052500000001000000000070060040000394000
000123000040050060000000000200000007760040082300000001000000000090080040000376000
000123000040050060000000000100000003560040072800000009000000000070060040000382000
000427000010090080000000000700000005120030046800000002000000000040060090000715000
000398000050020060000000000800000009620050041700000008000000000040060020000419000
000123000040050060000000000500000003760040052400000001000000000080060040000372000
000758000040060010000000000700000008120030045600000009000000000030010090000826000
000123000040050060000000000100000003760080041800000009000000000080060090000372000
000123000040050060000000000200000007360040052400000001000000000080060040000712000
000123000040050060000000000100000003260070081900000002000000000080060040000294000
000123000040050060000000000700000006360040082200000001000000000080060040000732000
000123000040050010000000000200000006670040052800000003000000000050010040000862000
000123000040050010000000000200000006630040072800000003000000000050010040000862000
000123000040050060000000000500000003360040057700000001000000000080060040000237000
000123000040050060000000000400000003760040052500000008000000000070090040000312000
000123000040050060000000000200000007760040082500000001000000000090080040000372000
000123000040050060000000000200000007760080092500000001000000000080060040000372000
000123000040050060000000000200000007780040092500000001000000000050090040000372000
000716000030050020000000000700000006120030045500000001000000000090040080000182000
=end